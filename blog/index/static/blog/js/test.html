<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>菜鸟教程(runoob.com)</title>
<style>

</style>
<script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js">
</script>

</head>

<body>
<!-- >
<div>
   <span style="cursor:auto">Auto</span><br />
      <span style="cursor:crosshair">Crosshair</span><br />
      <span style="cursor:default">Default</span><br />
      <span style="cursor:pointer">Pointer</span><br />
      <span style="cursor:move">Move</span><br />
     <span style="cursor:e-resize">e-resize</span><br />
     <span style="cursor:ne-resize">ne-resize</span><br />
    <span style="cursor:nw-resize">nw-resize</span><br />
     <span style="cursor:n-resize">n-resize</span><br />
     <span style="cursor:se-resize">se-resize</span><br />
     <span style="cursor:sw-resize">sw-resize</span><br />
     <span style="cursor:s-resize">s-resize</span><br />
     <span style="cursor:w-resize">w-resize</span><br />
     <span style="cursor:text">text</span><br />
     <span style="cursor:wait">wait</span><br />
     <span style="cursor:help">help</span>
    </div>
    <-->

<div class="typewriter" style="width: 400px;height: 400px;border: 5px solid cornflowerblue" contenteditable="true">
    Lorem ipsum dolor sit amet, consectetur adipiscing elit,
    sed do eiusmod tempor incididunt ut labore et dolore

</div>


<div id="box"  contenteditable=true>
	这是内容哦！
</div>


</body>
<script>

/*****Start Typewriter effect*****/
  $('.typewriter').css('display', 'none');
  setTimeout(function(){
    $('.typewriter').css('display', 'flex');

    var str = $('.typewriter').html(),
    i = 0,
    isTag,
    text,
    cursor = "|",
    timer;

    (function type() {
      text = str.slice(0, ++i);
      if (text === str){
        i = 0;
        blink();
        return;
      }
      $('.typewriter').html(text + " " + cursor);
      timer = setTimeout(type, 40);


    }());


    function blink() {
      i++;
      const foo = str + " " + (i%2 ? cursor : '');
      $('.typewriter').html(foo);
      if (i < 10) timer = setTimeout(blink, 600);
      else fade();
    }

    function fade() {
        $('.typewriter').html(str);
    }

  }, 300);
</script>
<script>
 var box= document.getElementById('box');
 setTimeout(function() {
     box.focus();
 }, 0);

</script>
  <script>
        var sendEmoji = document.getElementById('sendEmoji')

        // 定义最后光标对象
        var lastEditRange;

        // 编辑框点击事件
        document.getElementById('edit').onclick = function() {
            // 获取选定对象
            var selection = getSelection()
            // 设置最后光标对象
            lastEditRange = selection.getRangeAt(0)
        }

        // 编辑框按键弹起事件
        document.getElementById('edit').onkeyup = function() {
            // 获取选定对象
            var selection = getSelection()
            // 设置最后光标对象
            lastEditRange = selection.getRangeAt(0)
        }

        // 表情点击事件
        document.getElementById('sendEmoji').onclick = function() {
            // 获取编辑框对象
            var edit = document.getElementById('edit')
            // 获取输入框对象
            var emojiInput = document.getElementById('emojiInput')
            // 编辑框设置焦点
            edit.focus()
            // 获取选定对象
            var selection = getSelection()
            // 判断是否有最后光标对象存在
            if (lastEditRange) {
                // 存在最后光标对象，选定对象清除所有光标并添加最后光标还原之前的状态
                selection.removeAllRanges()
                selection.addRange(lastEditRange)
            }
            // 判断选定对象范围是编辑框还是文本节点
            if (selection.anchorNode.nodeName != '#text') {
                // 如果是编辑框范围。则创建表情文本节点进行插入
                var emojiText = document.createTextNode(emojiInput.value)

                if (edit.childNodes.length > 0) {
                    // 如果文本框的子元素大于0，则表示有其他元素，则按照位置插入表情节点
                    for (var i = 0; i < edit.childNodes.length; i++) {
                        if (i == selection.anchorOffset) {
                            edit.insertBefore(emojiText, edit.childNodes[i])
                        }
                    }
                } else {
                    // 否则直接插入一个表情元素
                    edit.appendChild(emojiText)
                }
                // 创建新的光标对象
                var range = document.createRange()
                // 光标对象的范围界定为新建的表情节点
                range.selectNodeContents(emojiText)
                // 光标位置定位在表情节点的最大长度
                range.setStart(emojiText, emojiText.length)
                // 使光标开始和光标结束重叠
                range.collapse(true)
                // 清除选定对象的所有光标对象
                selection.removeAllRanges()
                // 插入新的光标对象
                selection.addRange(range)
            } else {
                // 如果是文本节点则先获取光标对象
                var range = selection.getRangeAt(0)
                // 获取光标对象的范围界定对象，一般就是textNode对象
                var textNode = range.startContainer;
                // 获取光标位置
                var rangeStartOffset = range.startOffset;
                // 文本节点在光标位置处插入新的表情内容
                textNode.insertData(rangeStartOffset, emojiInput.value)
                // 光标移动到到原来的位置加上新内容的长度
                range.setStart(textNode, rangeStartOffset + emojiInput.value.length)
                // 光标开始和光标结束重叠
                range.collapse(true)
                // 清除选定对象的所有光标对象
                selection.removeAllRanges()
                // 插入新的光标对象
                selection.addRange(range)
            }
            // 无论如何都要记录最后光标对象
            lastEditRange = selection.getRangeAt(0)
        }
    </script>
</html>